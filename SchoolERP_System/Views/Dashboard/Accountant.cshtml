
@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_AccountantLayout.cshtml";
}



<div class="market-updates">
    <div class="col-md-3 market-update-gd">
        <div class="market-update-block clr-block-2">
            <div class="col-md-4 market-update-right">
                <i class="fa fa-users"> </i>
            </div>
            <div class="col-md-8 market-update-left">
                <h4>Student</h4>
                <h3><span id="student">0</span></h3>
                <a href="@Url.Action("ViewStudent", "MasterERP")" class="link"><p><span>All Student</span></p></a>
            </div>
            <div class="clearfix"> </div>
        </div>
    </div>
    <div class="col-md-3 market-update-gd">
        <div class="market-update-block clr-block-1">
            <div class="col-md-4 market-update-right">
                <i class="fa fa-money" style="font-size: 3em;color: #fff;text-align: left;"></i>
            </div>
            <div class="col-md-8 market-update-left">
                <h4>Fee</h4>
                <h3><span id="present">0</span></h3>
                <a href="@Url.Action("StudentFeesCollectionList", "Transaction")" class="link"><p><span>Month Collection</span></p></a>
            </div>
            <div class="clearfix"> </div>
        </div>
    </div>
    <div class="col-md-3 market-update-gd">
        <div class="market-update-block clr-block-3">
            <div class="col-md-4 market-update-right">
                <i class="fa fa-shopping-basket" style="font-size: 3em;color: #fff;text-align: left;"></i>
            </div>
            <div class="col-md-8 market-update-left">
                <h4>Expense</h4>
                <h3><span id="absent">0</span></h3>
                <a href="@Url.Action("ExpensesEntry", "Expenses")" class="link"><p><span>Month Expense</span></p></a>
            </div>
            <div class="clearfix"> </div>
        </div>
    </div>
    <div class="col-md-3 market-update-gd">
        <div class="market-update-block clr-block-4">
            <div class="col-md-4 market-update-right">
                <i class="fa fa-user-plus" aria-hidden="true" style="font-size: 3em;color: #fff;text-align: left;"></i>
            </div>
            <div class="col-md-8 market-update-left">
                <h4>Staff</h4>
                <h3><span id="due">0</span></h3>
                <a href="@Url.Action("ViewStaff", "MasterERP")" class="link"><p><span>All Staff's</span></p></a>
            </div>
            <div class="clearfix"> </div>
        </div>
    </div>
    <div class="clearfix"> </div>
</div>


<div class="agil-info-calendar">
    <!-- calendar -->
    <div class="col-md-6 agile-calendar">
        <div class="calendar-widget">
            <div class="panel-heading ui-sortable-handle">
                <span class="panel-icon">
                    <i class="fa fa-calendar-o"></i>
                </span>
                <span class="panel-title"> Calendar Widget</span>
            </div>
            <!-- grids -->
            <div class="agile-calendar-grid">
                <div class="page">

                    <div class="w3l-calendar-left">
                        <div class="calendar-heading">

                        </div>
                        <div class="monthly" id="mycalendar"></div>
                    </div>

                    <div class="clearfix"> </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6 w3agile-notifications">
        <div class="notifications">
            <header class="panel-heading">
                Notification
            </header>
            <div class="notify-w3ls">
                <marquee direction="up" height="465px" onmouseover="stop();" onMouseOut="start();">
                    <div id="dvNotice">

                    </div>
                </marquee>
            </div>
        </div>
    </div>
    <div class="clearfix"> </div>
</div>

@*<div class="agile-last-grids">
        <div class="col-md-4 agile-last-left">
            <div class="agile-last-grid">
                <div class="area-grids-heading">
                    <h3>Monthly</h3>
                </div>
                <div id="graph7"></div>
            </div>
        </div>
        <div class="col-md-4 agile-last-left agile-last-middle">
            <div class="agile-last-grid">
                <div class="area-grids-heading">
                    <h3>Daily</h3>
                </div>
                <div id="graph8"></div>
            </div>
        </div>
        <div class="col-md-4 agile-last-left agile-last-right">
            <div class="agile-last-grid">
                <div class="area-grids-heading">
                    <h3>Yearly</h3>
                </div>
                <div id="graph9"></div>
            </div>
        </div>
        <div class="clearfix"> </div>
    </div>*@


@section body_scripts{
    <script type="text/javascript">
        $(document).ready(function () {
            jQuery('.small-graph-box').hover(function () {
                jQuery(this).find('.box-button').fadeIn('fast');
            }, function () {
                jQuery(this).find('.box-button').fadeOut('fast');
            });
            jQuery('.small-graph-box .box-close').click(function () {
                jQuery(this).closest('.small-graph-box').fadeOut(200);
                return false;
            });

            Morris.Area({
                element: 'graph7',
                data: [
                    { x: '2013-03-30 22:00:00', y: 3, z: 3 },
                    { x: '2013-03-31 00:00:00', y: 2, z: 0 },
                    { x: '2013-03-31 02:00:00', y: 0, z: 2 },
                    { x: '2013-03-31 04:00:00', y: 4, z: 4 }
                ],
                xkey: 'x',
                ykeys: ['y', 'z'],
                labels: ['Y', 'Z']
            });

            /* data stolen from http://howmanyleft.co.uk/vehicle/jaguar_'e'_type */
            var day_data = [
                { "period": "2016-10-01", "licensed": 3407, "sorned": 660 },
                { "period": "2016-09-30", "licensed": 3351, "sorned": 629 },
                { "period": "2016-09-29", "licensed": 3269, "sorned": 618 },
                { "period": "2016-09-20", "licensed": 3246, "sorned": 661 },
                { "period": "2016-09-19", "licensed": 3257, "sorned": 667 },
                { "period": "2016-09-18", "licensed": 3248, "sorned": 627 },
                { "period": "2016-09-17", "licensed": 3171, "sorned": 660 },
                { "period": "2016-09-16", "licensed": 3171, "sorned": 676 },
                { "period": "2016-09-15", "licensed": 3201, "sorned": 656 },
                { "period": "2016-09-10", "licensed": 3215, "sorned": 622 }
            ];
            Morris.Bar({
                element: 'graph8',
                data: day_data,
                xkey: 'period',
                ykeys: ['licensed', 'sorned'],
                labels: ['Licensed', 'SORN'],
                xLabelAngle: 60
            });

            var day_data = [
                { "elapsed": "I", "value": 34 },
                { "elapsed": "II", "value": 24 },
                { "elapsed": "III", "value": 3 },
                { "elapsed": "IV", "value": 12 },
                { "elapsed": "V", "value": 13 },
                { "elapsed": "VI", "value": 22 },
                { "elapsed": "VII", "value": 5 },
                { "elapsed": "VIII", "value": 26 },
                { "elapsed": "IX", "value": 12 },
                { "elapsed": "X", "value": 19 }
            ];
            Morris.Line({
                element: 'graph9',
                data: day_data,
                xkey: 'elapsed',
                ykeys: ['value'],
                labels: ['value'],
                parseTime: false
            });

            //CHARTS
            function gd(year, day, month) {
                return new Date(year, month - 1, day).getTime();
            }

            graphArea2 = Morris.Area({
                element: 'hero-area',
                padding: 10,
                behaveLikeLine: true,
                gridEnabled: false,
                gridLineColor: '#dddddd',
                axes: true,
                resize: true,
                smooth: true,
                pointSize: 0,
                lineWidth: 0,
                fillOpacity: 0.85,
                data: [
                    { period: '2015 Q1', iphone: 2668, ipad: null, itouch: 2649 },
                    { period: '2015 Q2', iphone: 15780, ipad: 13799, itouch: 12051 },
                    { period: '2015 Q3', iphone: 12920, ipad: 10975, itouch: 9910 },
                    { period: '2015 Q4', iphone: 8770, ipad: 6600, itouch: 6695 },
                    { period: '2016 Q1', iphone: 10820, ipad: 10924, itouch: 12300 },
                    { period: '2016 Q2', iphone: 9680, ipad: 9010, itouch: 7891 },
                    { period: '2016 Q3', iphone: 4830, ipad: 3805, itouch: 1598 },
                    { period: '2016 Q4', iphone: 15083, ipad: 8977, itouch: 5185 },
                    { period: '2017 Q1', iphone: 10697, ipad: 4470, itouch: 2038 },

                ],
                lineColors: ['#eb6f6f', '#926383', '#eb6f6f'],
                xkey: 'period',
                redraw: true,
                ykeys: ['iphone', 'ipad', 'itouch'],
                labels: ['All Visitors', 'Returning Visitors', 'Unique Visitors'],
                pointSize: 2,
                hideHover: 'auto',
                resize: true
            });
        });

        $(window).load(function () {
            $('#mycalendar').monthly({
                mode: 'event',
            });

            $('#mycalendar2').monthly({
                mode: 'picker',
                target: '#mytarget',
                setWidth: '250px',
                startHidden: true,
                showTrigger: '#mytarget',
                stylePast: true,
                disablePast: true
            });
            //switch (window.location.protocol) {
            //    case 'http:':
            //    case 'https:':
            //        break;
            //    case 'file:':
            //        alert('Just a heads-up, events will not work when run locally.');
            //}

            fn_Bindtbl("0", "Accountant");
        });
        function fn_Bindtbl(_Id, Type) {
            $.ajax({
                type: "POST",
                url: '@Url.Action("viewDashboard", "Dashboard")',
                data: JSON.stringify({ ID: _Id, Type: Type }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                cache: false,
                success: function (data) {
                    if (Type == "Accountant") {
                        if (data[0] != null) {
                            $("#student").text(data[0][0].StudentCount);
                            $("#present").text(data[0][0].PresentCount);
                            $("#absent").text(data[0][0].AbsentCount);
                            $("#due").text(data[0][0].DueCount);
                        }
                        if (data[1] != null) {
                            $.each(data[1], function (rowIndex, val) {
                                var row = '';
                                if (rowIndex == 0 || rowIndex == 4 || rowIndex == 8 || rowIndex == 12 || rowIndex == 16 || rowIndex == 20) {
                                    row += '<div class="alert alert-info"><span class="alert-icon"><i class="fa fa-envelope-o"></i></span><div class="notification-info"><ul class="clearfix notification-meta">';
                                    row += '<li class="pull-left notification-sender">' + val.NTitle + '</li>';
                                    row += '<li class="pull-right notification-time">' + val.NDate + '</li></ul>';
                                    row += '<p>' + val.NDescription + '</p></div></div>';
                                }
                                else if (rowIndex == 1 || rowIndex == 5 || rowIndex == 9 || rowIndex == 13 || rowIndex == 17 || rowIndex == 21) {
                                    row += '<div class="alert alert-danger"><span class="alert-icon"><i class="fa fa-quote-left"></i></span><div class="notification-info"><ul class="clearfix notification-meta">';
                                    row += '<li class="pull-left notification-sender">' + val.NTitle + '</li>';
                                    row += '<li class="pull-right notification-time">' + val.NDate + '</li></ul>';
                                    row += '<p>' + val.NDescription + '</p></div></div>';
                                }
                                else if (rowIndex == 2 || rowIndex == 6 || rowIndex == 10 || rowIndex == 14 || rowIndex == 18 || rowIndex == 22) {
                                    row += '<div class="alert alert-success"><span class="alert-icon"><i class="fa fa-comments-o"></i></span><div class="notification-info"><ul class="clearfix notification-meta">';
                                    row += '<li class="pull-left notification-sender">' + val.NTitle + '</li>';
                                    row += '<li class="pull-right notification-time">' + val.NDate + '</li></ul>';
                                    row += '<p>' + val.NDescription + '</p></div></div>';
                                }
                                else if (rowIndex == 3 || rowIndex == 7 || rowIndex == 11 || rowIndex == 15 || rowIndex == 19 || rowIndex == 23) {
                                    row += '<div class="alert alert-warning"><span class="alert-icon"><i class="fa fa-bell-o"></i></span><div class="notification-info"><ul class="clearfix notification-meta">';
                                    row += '<li class="pull-left notification-sender">' + val.NTitle + '</li>';
                                    row += '<li class="pull-right notification-time">' + val.NDate + '</li></ul>';
                                    row += '<p>' + val.NDescription + '</p></div></div>';
                                }
                                else {
                                    row += '<div class="alert alert-info"><span class="alert-icon"><i class="fa fa-rss"></i></span><div class="notification-info"><ul class="clearfix notification-meta">';
                                    row += '<li class="pull-left notification-sender">' + val.NTitle + '</li>';
                                    row += '<li class="pull-right notification-time">' + val.NDate + '</li></ul>';
                                    row += '<p>' + val.NDescription + '</p></div></div>';
                                }
                                $('#dvNotice').append(row);
                            });
                        }
                    }
                },
                error: function (error) {
                    console.error(error);
                    //FormSuccessError(error, "Error", "errorBlock");
                    return false;
                }
            });
        }
    </script>
}
